<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FireTVCast</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root {
            --apple-blue: #007AFF;
            --bg-gradient: radial-gradient(circle at 50% 50%, #1c1c1e 0%, #000000 100%);
        }
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-gradient);
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            overflow: hidden;
        }
        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 60px 80px;
            border-radius: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            max-width: 600px;
            transition: all 0.5s ease;
        }
        .icon-circle {
            width: 100px;
            height: 100px;
            background: var(--apple-blue);
            border-radius: 22px; /* iOS Icon Radius */
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0, 122, 255, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 600;
            margin: 0 0 10px;
            letter-spacing: -0.5px;
        }
        p {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 30px;
        }
        .status-badge {
            display: inline-block;
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 100px;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--apple-blue);
        }
        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="icon-circle">
            <svg width="50" height="50" viewBox="0 0 24 24" fill="white">
                <path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"/>
            </svg>
        </div>
        <h1>FireTvCast</h1>
        <p id="msg">他のブラウザから<br>ページを転送してください</p>
        <div id="ip-status" class="status-badge">
            <span class="loading-dots">接続を準備中</span>
        </div>
    </div>

    <script>
        fetch('https://api.ipify.org?format=json')
            .then(res => res.json())
            .then(data => {
                const networkID = "firetv-" + data.ip.replace(/\./g, "-");
                startPeer(networkID);
            });

        function startPeer(id) {
            const peer = new Peer(id);
            peer.on('open', () => {
                document.getElementById('ip-status').innerText = "● 接続待機中 (Same Wi-Fi Only)";
            });
            peer.on('connection', (conn) => {
                conn.on('data', (url) => {
                    if (url && url.startsWith('http')) {
                        document.querySelector('.container').style.opacity = "0";
                        document.querySelector('.container').style.transform = "scale(0.9)";
                        setTimeout(() => { window.location.href = url; }, 500);
                    }
                });
            });
        }
    </script>
</body>
</html>
